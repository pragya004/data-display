{"ast":null,"code":"import { __rest } from \"tslib\";\nimport defaults from 'lodash/defaults';\nimport { Helpers, TextSize } from 'victory-core';\nimport { VictoryLegend } from 'victory-legend';\nimport { ChartCommonStyles } from '../ChartTheme';\nimport { getPieOrigin } from './chart-origin';\nimport * as React from 'react'; // Returns a legend which has been positioned per the given chart properties\n\nexport const getComputedLegend = ({\n  allowWrap = true,\n  chartType = 'chart',\n  dx = 0,\n  dy = 0,\n  height,\n  legendComponent,\n  padding,\n  position = ChartCommonStyles.legend.position,\n  theme,\n  width,\n  // destructure last\n  orientation = theme.legend.orientation\n}) => {\n  // Get the number of legend items per row\n  const legendItemsProps = legendComponent.props ? legendComponent.props : {};\n  const legendItemsPerRow = allowWrap ? getLegendItemsPerRow({\n    chartType,\n    dx,\n    height,\n    legendData: legendItemsProps.data,\n    legendOrientation: legendItemsProps.legendOrientation ? legendItemsProps.legendOrientation : orientation,\n    legendPosition: position,\n    legendProps: legendItemsProps,\n    padding,\n    theme,\n    width\n  }) : undefined; // Include new itemsPerRow prop when determining x and y position\n\n  const legendPositionProps = defaults({}, legendComponent.props, {\n    itemsPerRow: legendItemsPerRow\n  });\n  const legendX = getLegendX({\n    chartType,\n    dx,\n    height,\n    legendData: legendPositionProps.data,\n    legendOrientation: legendPositionProps.legendOrientation ? legendPositionProps.legendOrientation : orientation,\n    legendPosition: position,\n    legendProps: legendPositionProps,\n    padding,\n    theme,\n    width\n  });\n  const legendY = getLegendY({\n    chartType,\n    dy,\n    height,\n    legendData: legendPositionProps.data,\n    legendOrientation: legendPositionProps.legendOrientation ? legendPositionProps.legendOrientation : orientation,\n    legendProps: legendPositionProps,\n    legendPosition: position,\n    padding,\n    theme,\n    width\n  }); // Clone legend with updated props\n\n  const legendProps = defaults({}, legendComponent.props, {\n    itemsPerRow: legendItemsPerRow,\n    orientation,\n    standalone: false,\n    theme,\n    x: legendX > 0 ? legendX : 0,\n    y: legendY > 0 ? legendY : 0\n  });\n  return React.cloneElement(legendComponent, legendProps);\n}; // Returns legend dimensions\n\nexport const getLegendDimensions = ({\n  legendData,\n  legendOrientation,\n  legendProps,\n  theme\n}) => {\n  if (legendData || legendProps.data) {\n    return VictoryLegend.getDimensions(Object.assign({\n      data: legendData,\n      orientation: legendOrientation,\n      theme\n    }, legendProps // override above\n    ));\n  }\n\n  return {};\n}; // Returns true if the legend is smaller than its container\n\nexport const doesLegendFit = ({\n  dx = 0,\n  height,\n  legendPosition,\n  legendData,\n  legendOrientation,\n  legendProps,\n  padding,\n  theme,\n  width\n}) => {\n  const {\n    left,\n    right\n  } = Helpers.getPadding({\n    padding\n  });\n  const chartSize = {\n    height,\n    width: width - left - right\n  };\n  const legendDimensions = getLegendDimensions({\n    legendData,\n    legendOrientation,\n    legendProps,\n    theme\n  });\n  let occupiedWidth = 0;\n\n  switch (legendPosition) {\n    case 'bottom-left':\n      occupiedWidth = left + dx;\n      break;\n\n    case 'right':\n      occupiedWidth = chartSize.width + ChartCommonStyles.legend.margin + left + dx;\n      break;\n\n    default:\n      occupiedWidth = dx;\n      break;\n  }\n\n  return width - occupiedWidth > legendDimensions.width;\n}; // Returns the number of legend items per row\n\nexport const getLegendItemsPerRow = ({\n  dx,\n  height,\n  legendPosition,\n  legendData,\n  legendOrientation,\n  legendProps,\n  padding,\n  theme,\n  width\n}) => {\n  let itemsPerRow = legendData ? legendData.length : 0;\n\n  for (let i = itemsPerRow; i > 0; i--) {\n    const fits = doesLegendFit({\n      dx,\n      height,\n      legendPosition,\n      legendData,\n      legendOrientation,\n      legendProps: Object.assign(Object.assign({}, legendProps), {\n        itemsPerRow: i\n      }),\n      padding,\n      theme,\n      width\n    });\n\n    if (fits) {\n      itemsPerRow = i;\n      break;\n    }\n  }\n\n  return itemsPerRow;\n}; // Returns x coordinate for legend\n\nexport const getLegendX = _a => {\n  var {\n    chartType\n  } = _a,\n      rest = __rest(_a, [\"chartType\"]);\n\n  return chartType === 'pie' ? getPieLegendX(rest) : getChartLegendX(rest);\n}; // Returns y coordinate for legend\n\nexport const getLegendY = _a => {\n  var {\n    chartType\n  } = _a,\n      rest = __rest(_a, [\"chartType\"]);\n\n  switch (chartType) {\n    case 'pie':\n      return getPieLegendY(rest);\n\n    case 'bullet':\n      return getBulletLegendY(rest);\n\n    default:\n      return getChartLegendY(rest);\n  }\n}; // Returns y coordinate for bullet legends\n\nexport const getBulletLegendY = ({\n  dy = 0,\n  height,\n  legendPosition,\n  legendData,\n  legendOrientation,\n  legendProps,\n  padding,\n  theme,\n  width\n}) => {\n  const {\n    left,\n    right\n  } = Helpers.getPadding({\n    padding\n  });\n  const chartSize = {\n    height,\n    width: width - left - right\n  };\n\n  switch (legendPosition) {\n    case 'bottom':\n    case 'bottom-left':\n      return chartSize.height + ChartCommonStyles.legend.margin + dy;\n\n    case 'right':\n      {\n        // Legend height with padding\n        const legendDimensions = getLegendDimensions({\n          legendData,\n          legendOrientation,\n          legendProps,\n          theme\n        });\n\n        const legendPadding = legendDataArr => legendDataArr && legendDataArr.length > 0 ? 17 : 0;\n\n        return (chartSize.height - legendDimensions.height) / 2 + legendPadding(legendData);\n      }\n\n    default:\n      return dy;\n  }\n}; // Returns x coordinate for chart legends\n\nexport const getChartLegendX = ({\n  dx = 0,\n  height,\n  legendData,\n  legendOrientation,\n  legendPosition,\n  legendProps,\n  padding,\n  theme,\n  width\n}) => {\n  const {\n    top,\n    bottom,\n    left,\n    right\n  } = Helpers.getPadding({\n    padding\n  });\n  const chartSize = {\n    height: Math.abs(height - (bottom + top)),\n    width: Math.abs(width - (left + right))\n  };\n  const legendDimensions = getLegendDimensions({\n    legendData,\n    legendOrientation,\n    legendProps,\n    theme\n  });\n\n  switch (legendPosition) {\n    case 'bottom':\n      return width > legendDimensions.width ? Math.round((width - legendDimensions.width) / 2) + dx : dx;\n\n    case 'bottom-left':\n      return left + dx;\n\n    case 'right':\n      return chartSize.width + ChartCommonStyles.legend.margin + left + dx;\n\n    default:\n      return dx;\n  }\n}; // Returns y coordinate for chart legends\n\nexport const getChartLegendY = ({\n  dy = 0,\n  height,\n  legendPosition,\n  legendData,\n  legendOrientation,\n  legendProps,\n  padding,\n  theme,\n  width\n}) => {\n  const {\n    top,\n    bottom,\n    left,\n    right\n  } = Helpers.getPadding({\n    padding\n  });\n  const chartSize = {\n    height: Math.abs(height - (bottom + top)),\n    width: Math.abs(width - (left + right))\n  };\n\n  switch (legendPosition) {\n    case 'bottom':\n    case 'bottom-left':\n      return chartSize.height + ChartCommonStyles.legend.margin * 2 + top + dy;\n\n    case 'right':\n      {\n        // Legend height with padding\n        const legendDimensions = getLegendDimensions({\n          legendData,\n          legendOrientation,\n          legendProps,\n          theme\n        });\n        const originX = chartSize.height / 2 + top;\n\n        const legendPadding = legendDataArr => legendDataArr && legendDataArr.length > 0 ? 2 : 0;\n\n        return originX - legendDimensions.height / 2 + legendPadding(legendData);\n      }\n\n    default:\n      return dy;\n  }\n}; // Returns x coordinate for pie legends\n\nexport const getPieLegendX = ({\n  dx = 0,\n  height,\n  legendData,\n  legendOrientation,\n  legendPosition,\n  legendProps,\n  padding,\n  theme,\n  width\n}) => {\n  const origin = getPieOrigin({\n    height,\n    padding,\n    width\n  });\n  const radius = Helpers.getRadius({\n    height,\n    width,\n    padding\n  });\n  const legendDimensions = getLegendDimensions({\n    legendData,\n    legendOrientation,\n    legendProps,\n    theme\n  });\n\n  switch (legendPosition) {\n    case 'bottom':\n      return width > legendDimensions.width ? Math.round((width - legendDimensions.width) / 2) + dx : dx;\n\n    case 'right':\n      return origin.x + ChartCommonStyles.label.margin + dx + radius;\n\n    default:\n      return dx;\n  }\n}; // Returns y coordinate for pie legends\n\nexport const getPieLegendY = ({\n  dy = 0,\n  height,\n  legendPosition,\n  legendData,\n  legendOrientation,\n  legendProps,\n  padding,\n  theme,\n  width\n}) => {\n  const origin = getPieOrigin({\n    height,\n    padding,\n    width\n  });\n  const radius = Helpers.getRadius({\n    height,\n    width,\n    padding\n  });\n\n  switch (legendPosition) {\n    case 'bottom':\n      return origin.y + ChartCommonStyles.legend.margin + radius + dy;\n\n    case 'right':\n      {\n        // Legend height with padding\n        const legendDimensions = getLegendDimensions({\n          legendData,\n          legendOrientation,\n          legendProps,\n          theme\n        });\n\n        const legendPadding = legendDataArr => legendDataArr && legendDataArr.length > 0 ? 2 : 0;\n\n        return origin.y - legendDimensions.height / 2 + legendPadding(legendData);\n      }\n\n    default:\n      return dy;\n  }\n}; // Returns an approximation of longest text width based on legend styles\n\nexport const getMaxLegendTextSize = ({\n  legendData,\n  theme\n}) => {\n  const style = theme && theme.legend && theme.legend.style ? theme.legend.style.labels : undefined;\n\n  if (!(legendData && legendData.length)) {\n    return 0;\n  }\n\n  let result = '';\n  legendData.forEach(data => {\n    if (data.name && data.name.length > result.length) {\n      result = data.name;\n    }\n  }); // The approximateTextSize function returns height and width, but Victory incorrectly typed it as number\n\n  const adjustedTextSize = TextSize.approximateTextSize(result, Object.assign({}, style));\n  return adjustedTextSize.width;\n};","map":{"version":3,"sources":["../../../../src/components/ChartUtils/chart-legend.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { __rest } from \"tslib\";\nimport defaults from 'lodash/defaults';\nimport { Helpers, TextSize } from 'victory-core';\nimport { VictoryLegend } from 'victory-legend';\nimport { ChartCommonStyles } from '../ChartTheme';\nimport { getPieOrigin } from './chart-origin';\nimport * as React from 'react';\n// Returns a legend which has been positioned per the given chart properties\nexport const getComputedLegend = ({ allowWrap = true, chartType = 'chart', dx = 0, dy = 0, height, legendComponent, padding, position = ChartCommonStyles.legend.position, theme, width, \n// destructure last\norientation = theme.legend.orientation }) => {\n    // Get the number of legend items per row\n    const legendItemsProps = legendComponent.props ? legendComponent.props : {};\n    const legendItemsPerRow = allowWrap\n        ? getLegendItemsPerRow({\n            chartType,\n            dx,\n            height,\n            legendData: legendItemsProps.data,\n            legendOrientation: legendItemsProps.legendOrientation ? legendItemsProps.legendOrientation : orientation,\n            legendPosition: position,\n            legendProps: legendItemsProps,\n            padding,\n            theme,\n            width\n        })\n        : undefined;\n    // Include new itemsPerRow prop when determining x and y position\n    const legendPositionProps = defaults({}, legendComponent.props, {\n        itemsPerRow: legendItemsPerRow\n    });\n    const legendX = getLegendX({\n        chartType,\n        dx,\n        height,\n        legendData: legendPositionProps.data,\n        legendOrientation: legendPositionProps.legendOrientation ? legendPositionProps.legendOrientation : orientation,\n        legendPosition: position,\n        legendProps: legendPositionProps,\n        padding,\n        theme,\n        width\n    });\n    const legendY = getLegendY({\n        chartType,\n        dy,\n        height,\n        legendData: legendPositionProps.data,\n        legendOrientation: legendPositionProps.legendOrientation ? legendPositionProps.legendOrientation : orientation,\n        legendProps: legendPositionProps,\n        legendPosition: position,\n        padding,\n        theme,\n        width\n    });\n    // Clone legend with updated props\n    const legendProps = defaults({}, legendComponent.props, {\n        itemsPerRow: legendItemsPerRow,\n        orientation,\n        standalone: false,\n        theme,\n        x: legendX > 0 ? legendX : 0,\n        y: legendY > 0 ? legendY : 0\n    });\n    return React.cloneElement(legendComponent, legendProps);\n};\n// Returns legend dimensions\nexport const getLegendDimensions = ({ legendData, legendOrientation, legendProps, theme }) => {\n    if (legendData || legendProps.data) {\n        return VictoryLegend.getDimensions(Object.assign({ data: legendData, orientation: legendOrientation, theme }, legendProps // override above\n        ));\n    }\n    return {};\n};\n// Returns true if the legend is smaller than its container\nexport const doesLegendFit = ({ dx = 0, height, legendPosition, legendData, legendOrientation, legendProps, padding, theme, width }) => {\n    const { left, right } = Helpers.getPadding({ padding });\n    const chartSize = {\n        height,\n        width: width - left - right\n    };\n    const legendDimensions = getLegendDimensions({\n        legendData,\n        legendOrientation,\n        legendProps,\n        theme\n    });\n    let occupiedWidth = 0;\n    switch (legendPosition) {\n        case 'bottom-left':\n            occupiedWidth = left + dx;\n            break;\n        case 'right':\n            occupiedWidth = chartSize.width + ChartCommonStyles.legend.margin + left + dx;\n            break;\n        default:\n            occupiedWidth = dx;\n            break;\n    }\n    return width - occupiedWidth > legendDimensions.width;\n};\n// Returns the number of legend items per row\nexport const getLegendItemsPerRow = ({ dx, height, legendPosition, legendData, legendOrientation, legendProps, padding, theme, width }) => {\n    let itemsPerRow = legendData ? legendData.length : 0;\n    for (let i = itemsPerRow; i > 0; i--) {\n        const fits = doesLegendFit({\n            dx,\n            height,\n            legendPosition,\n            legendData,\n            legendOrientation,\n            legendProps: Object.assign(Object.assign({}, legendProps), { itemsPerRow: i }),\n            padding,\n            theme,\n            width\n        });\n        if (fits) {\n            itemsPerRow = i;\n            break;\n        }\n    }\n    return itemsPerRow;\n};\n// Returns x coordinate for legend\nexport const getLegendX = (_a) => {\n    var { chartType } = _a, rest = __rest(_a, [\"chartType\"]);\n    return chartType === 'pie' ? getPieLegendX(rest) : getChartLegendX(rest);\n};\n// Returns y coordinate for legend\nexport const getLegendY = (_a) => {\n    var { chartType } = _a, rest = __rest(_a, [\"chartType\"]);\n    switch (chartType) {\n        case 'pie':\n            return getPieLegendY(rest);\n        case 'bullet':\n            return getBulletLegendY(rest);\n        default:\n            return getChartLegendY(rest);\n    }\n};\n// Returns y coordinate for bullet legends\nexport const getBulletLegendY = ({ dy = 0, height, legendPosition, legendData, legendOrientation, legendProps, padding, theme, width }) => {\n    const { left, right } = Helpers.getPadding({ padding });\n    const chartSize = {\n        height,\n        width: width - left - right\n    };\n    switch (legendPosition) {\n        case 'bottom':\n        case 'bottom-left':\n            return chartSize.height + ChartCommonStyles.legend.margin + dy;\n        case 'right': {\n            // Legend height with padding\n            const legendDimensions = getLegendDimensions({\n                legendData,\n                legendOrientation,\n                legendProps,\n                theme\n            });\n            const legendPadding = (legendDataArr) => (legendDataArr && legendDataArr.length > 0 ? 17 : 0);\n            return (chartSize.height - legendDimensions.height) / 2 + legendPadding(legendData);\n        }\n        default:\n            return dy;\n    }\n};\n// Returns x coordinate for chart legends\nexport const getChartLegendX = ({ dx = 0, height, legendData, legendOrientation, legendPosition, legendProps, padding, theme, width }) => {\n    const { top, bottom, left, right } = Helpers.getPadding({ padding });\n    const chartSize = {\n        height: Math.abs(height - (bottom + top)),\n        width: Math.abs(width - (left + right))\n    };\n    const legendDimensions = getLegendDimensions({\n        legendData,\n        legendOrientation,\n        legendProps,\n        theme\n    });\n    switch (legendPosition) {\n        case 'bottom':\n            return width > legendDimensions.width ? Math.round((width - legendDimensions.width) / 2) + dx : dx;\n        case 'bottom-left':\n            return left + dx;\n        case 'right':\n            return chartSize.width + ChartCommonStyles.legend.margin + left + dx;\n        default:\n            return dx;\n    }\n};\n// Returns y coordinate for chart legends\nexport const getChartLegendY = ({ dy = 0, height, legendPosition, legendData, legendOrientation, legendProps, padding, theme, width }) => {\n    const { top, bottom, left, right } = Helpers.getPadding({ padding });\n    const chartSize = {\n        height: Math.abs(height - (bottom + top)),\n        width: Math.abs(width - (left + right))\n    };\n    switch (legendPosition) {\n        case 'bottom':\n        case 'bottom-left':\n            return chartSize.height + ChartCommonStyles.legend.margin * 2 + top + dy;\n        case 'right': {\n            // Legend height with padding\n            const legendDimensions = getLegendDimensions({\n                legendData,\n                legendOrientation,\n                legendProps,\n                theme\n            });\n            const originX = chartSize.height / 2 + top;\n            const legendPadding = (legendDataArr) => (legendDataArr && legendDataArr.length > 0 ? 2 : 0);\n            return originX - legendDimensions.height / 2 + legendPadding(legendData);\n        }\n        default:\n            return dy;\n    }\n};\n// Returns x coordinate for pie legends\nexport const getPieLegendX = ({ dx = 0, height, legendData, legendOrientation, legendPosition, legendProps, padding, theme, width }) => {\n    const origin = getPieOrigin({ height, padding, width });\n    const radius = Helpers.getRadius({ height, width, padding });\n    const legendDimensions = getLegendDimensions({\n        legendData,\n        legendOrientation,\n        legendProps,\n        theme\n    });\n    switch (legendPosition) {\n        case 'bottom':\n            return width > legendDimensions.width ? Math.round((width - legendDimensions.width) / 2) + dx : dx;\n        case 'right':\n            return origin.x + ChartCommonStyles.label.margin + dx + radius;\n        default:\n            return dx;\n    }\n};\n// Returns y coordinate for pie legends\nexport const getPieLegendY = ({ dy = 0, height, legendPosition, legendData, legendOrientation, legendProps, padding, theme, width }) => {\n    const origin = getPieOrigin({ height, padding, width });\n    const radius = Helpers.getRadius({ height, width, padding });\n    switch (legendPosition) {\n        case 'bottom':\n            return origin.y + ChartCommonStyles.legend.margin + radius + dy;\n        case 'right': {\n            // Legend height with padding\n            const legendDimensions = getLegendDimensions({\n                legendData,\n                legendOrientation,\n                legendProps,\n                theme\n            });\n            const legendPadding = (legendDataArr) => (legendDataArr && legendDataArr.length > 0 ? 2 : 0);\n            return origin.y - legendDimensions.height / 2 + legendPadding(legendData);\n        }\n        default:\n            return dy;\n    }\n};\n// Returns an approximation of longest text width based on legend styles\nexport const getMaxLegendTextSize = ({ legendData, theme }) => {\n    const style = theme && theme.legend && theme.legend.style ? theme.legend.style.labels : undefined;\n    if (!(legendData && legendData.length)) {\n        return 0;\n    }\n    let result = '';\n    legendData.forEach(data => {\n        if (data.name && data.name.length > result.length) {\n            result = data.name;\n        }\n    });\n    // The approximateTextSize function returns height and width, but Victory incorrectly typed it as number\n    const adjustedTextSize = TextSize.approximateTextSize(result, Object.assign({}, style));\n    return adjustedTextSize.width;\n};\n//# sourceMappingURL=chart-legend.js.map"]},"metadata":{},"sourceType":"module"}